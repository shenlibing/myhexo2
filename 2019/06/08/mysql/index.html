<!DOCTYPE HTML>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="mysql, 小兵兵">
    <meta name="description" content="安装下载MySQL :: Download MySQL Community Server (Archived Versions)

rzsz[root@192 modules]# yum -y  install lrzsz上传[root@1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>mysql | 小兵兵</title>
    <link rel="icon" type="image/png" href="/乌龟.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
        code[class*="language-"], pre[class*="language-"] {
            white-space: pre !important;
        }
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/乌龟.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">小兵兵</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>友情链接</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/乌龟.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">小兵兵</div>
        <div class="logo-desc">
            
            言宜慢，心宜善
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                标签
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                关于
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                友情链接
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/shenlibing/" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/shenlibing/" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>





<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/2.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        mysql
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/mysql/" target="_blank">
                                <span class="chip bg-color">mysql</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/数据库/" class="post-category" target="_blank">
                                数据库
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2019-06-08
                </div>

                
                    
                    <div class="info-break-policy">
                        <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                        8.8k
                    </div>
                    

                    
                    <div class="info-break-policy">
                        <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                        47 分
                    </div>
                    
                
				
				
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p><a href="https://downloads.mysql.com/archives/community/" target="_blank" rel="noopener">MySQL :: Download MySQL Community Server (Archived Versions)</a></p>
<p><img src="https://raw.githubusercontent.com/shenlibing/blogphoto/master/source/1559999836333.png" alt="1559999836333"></p>
<h2 id="rzsz"><a href="#rzsz" class="headerlink" title="rzsz"></a>rzsz</h2><pre><code>[root@192 modules]# yum -y  install lrzsz</code></pre><h2 id="上传"><a href="#上传" class="headerlink" title="上传"></a>上传</h2><pre><code>[root@192 modules]# ll
total 66632
-rw-r--r--. 1 root root 17855952 Jun  8 20:04 MySQL-client-5.5.48-1.linux2.6.x86_64.rpm
-rw-r--r--. 1 root root 50372369 Jun  8 20:24 MySQL-server-5.5.48-1.linux2.6.x86_64.rpm
</code></pre><h2 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h2><h3 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h3><pre><code>[root@192 modules]# rpm -qa | grep -i mysql
mysql-libs-5.1.73-7.el6.x86_64
[root@192 modules]# rpm -e --nodeps mysql-libs-5.1.73-7.el6.x86_64</code></pre><h3 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h3><pre><code>[root@192 modules]# yum -y remove mysql-libs-5.1.73-7.el6.x86_64</code></pre><p>如果提示<code>“GPG keys...”</code>安装失败，解决方案：<code>rpm -ivh rpm软件名  --force --nodoeps</code></p>
<h2 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h2><pre><code>[root@192 modules]# rpm -ivh MySQL-server-5.5.48-1.linux2.6.x86_64.rpm 
warning: MySQL-server-5.5.48-1.linux2.6.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY
Preparing...                ########################################### [100%]
   1:MySQL-server           ########################################### [100%]
190608 20:32:37 [Note] /usr/sbin/mysqld (mysqld 5.5.48) starting as process 26375 ...
190608 20:32:37 [Note] /usr/sbin/mysqld (mysqld 5.5.48) starting as process 26382 ...

PLEASE REMEMBER TO SET A PASSWORD FOR THE MySQL root USER !
To do so, start the server, then issue the following commands:

/usr/bin/mysqladmin -u root password &#39;new-password&#39;
/usr/bin/mysqladmin -u root -h 192.168.1.101 password &#39;new-password&#39;

Alternatively you can run:
/usr/bin/mysql_secure_installation

which will also give you the option of removing the test
databases and anonymous user created by default.  This is
strongly recommended for production servers.

See the manual for more instructions.

Please report any problems at http://bugs.mysql.com/</code></pre><h2 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h2><pre><code>[root@192 modules]# rpm -ivh MySQL-client-5.5.48-1.linux2.6.x86_64.rpm 
warning: MySQL-client-5.5.48-1.linux2.6.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY
Preparing...                ########################################### [100%]
   1:MySQL-client           ########################################### [100%]</code></pre><h2 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h2><pre><code>[root@192 mysql]# mysqladmin --version
mysqladmin  Ver 8.42 Distrib 5.5.48, for Linux on x86_64</code></pre><h2 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h2><h3 id="方式一-1"><a href="#方式一-1" class="headerlink" title="方式一"></a>方式一</h3><pre><code>[root@192 mysql]# service mysql start;
Starting MySQL..                                           [  OK  ]
</code></pre><h3 id="方式二-1"><a href="#方式二-1" class="headerlink" title="方式二"></a>方式二</h3><ul>
<li>在计算机<code>reboot</code>后 登陆<code>MySQL</code> : <code>mysql</code>可能会报错：  <code>&quot;/var/lib/mysql/mysql.sock不存在&quot;</code><ul>
<li>原因：是<code>Mysql</code>服务没有启动</li>
<li>解决 ：  启动服务<ol>
<li>每次使用前 手动启动服务  <code>/etc/init.d/mysql start</code> </li>
<li>开机自启  <code>chkconfig mysql on</code>    ,<code>chkconfig mysql off</code></li>
</ol>
</li>
</ul>
</li>
</ul>
<pre><code>[root@192 modules]# /etc/init.d/mysql start
Starting MySQL..                                           [  OK  ]</code></pre><h3 id="方式三"><a href="#方式三" class="headerlink" title="方式三"></a>方式三</h3><ul>
<li>开启自启<code>mysql</code>服务</li>
</ul>
<pre><code>[root@192 mysql]# chkconfig mysql on
[root@192 mysql]# chkconfig mysql --list
mysql              0:off    1:off    2:on    3:on    4:on    5:on    6:off</code></pre><h2 id="关闭服务"><a href="#关闭服务" class="headerlink" title="关闭服务"></a>关闭服务</h2><pre><code>[root@192 mysql]# service mysql stop
Shutting down MySQL...                                     [  OK  ]</code></pre><h2 id="重启服务"><a href="#重启服务" class="headerlink" title="重启服务"></a>重启服务</h2><pre><code>[root@192 mysql]# service mysql restart;
Shutting down MySQL.                                       [  OK  ]
Starting MySQL..                                           [  OK  ]</code></pre><h2 id="检查开机是否自动启动mysql服务"><a href="#检查开机是否自动启动mysql服务" class="headerlink" title="检查开机是否自动启动mysql服务"></a>检查开机是否自动启动mysql服务</h2><pre><code>[root@192 mysql]# ntsysv</code></pre><p><img src="https://raw.githubusercontent.com/shenlibing/blogphoto/master/source/1560149842747.png" alt="1560149842747"></p>
<h2 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h2><pre><code>[root@192 modules]# /usr/bin/mysqladmin -u root password &#39;000000&#39;</code></pre><h2 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h2><pre><code>[root@192 modules]# mysql -uroot -p
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 2
Server version: 5.5.48 MySQL Community Server (GPL)

Copyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.

mysql&gt; </code></pre><h2 id="授权"><a href="#授权" class="headerlink" title="授权"></a>授权</h2><pre><code>mysql&gt; grant all privileges  on *.* to root@&#39;%&#39; identified by &quot;000000&quot;;
Query OK, 0 rows affected (0.00 sec)
mysql&gt; FLUSH PRIVILEGES;
Query OK, 0 rows affected (0.00 sec)</code></pre><h2 id="坑"><a href="#坑" class="headerlink" title="坑"></a>坑</h2><ul>
<li><p>客户端连接不上</p>
<p><img src="https://raw.githubusercontent.com/shenlibing/blogphoto/master/source/1560004124502.png" alt="1560004124502"></p>
<ul>
<li><p>关闭防火墙</p>
<pre><code>[root@192 ~]# service iptables stop;
iptables: Setting chains to policy ACCEPT: filter          [  OK  ]
iptables: Flushing firewall rules:                         [  OK  ]
iptables: Unloading modules:                               [  OK  ]
[root@192 ~]# service iptables status;
iptables: Firewall is not running.</code></pre></li>
</ul>
</li>
<li><p><code>rpm</code>安装<code>mysql</code>，找不到<code>/etc/my.cnf</code></p>
<ul>
<li>复制<code>/usr/share/mysql</code>目录下的<code>my-huge.cnf</code>文件到<code>/etc</code>目录，并改名为<code>my.cnf</code>即可</li>
</ul>
</li>
</ul>
<pre><code>[root@192 mysql]# cp /usr/share/mysql/my-huge.cnf /etc/my.cnf</code></pre><h1 id="数据库存放目录"><a href="#数据库存放目录" class="headerlink" title="数据库存放目录"></a>数据库存放目录</h1><pre><code>[root@192 mysql]# ps -ef|grep mysql
root       5790   3618  0 14:13 pts/1    00:00:00 mysql -uroot -p
root       5802   4605  0 14:24 pts/3    00:00:00 mysql -uroot -p
root       7266      1  0 14:46 pts/0    00:00:00 /bin/sh /usr/bin/mysqld_safe --datadir=/var/lib/mysql --pid-file=/var/lib/mysql/192.168.1.101.pid
mysql      7615   7266  0 14:46 pts/0    00:00:00 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib64/mysql/plugin --user=mysql --log-error=/var/lib/mysql/192.168.1.101.err --pid-file=/var/lib/mysql/192.168.1.101.pid --socket=/var/lib/mysql/mysql.sock --port=3306
root       7672   4519  0 15:02 pts/0    00:00:00 grep mysql</code></pre><ul>
<li>数据库目录<code>datadir=/var/lib/mysql</code></li>
<li><code>pid</code>文件目录：<code>--pid-file=/var/lib/mysql/bigdata01.pid</code></li>
</ul>
<h2 id="MySQL核心目录"><a href="#MySQL核心目录" class="headerlink" title="MySQL核心目录"></a>MySQL核心目录</h2><ul>
<li>/var/lib/mysql :mysql 安装目录</li>
<li>/usr/share/mysql:  配置文件</li>
<li>/usr/bin：命令目录（mysqladmin、mysqldump等）</li>
<li>/etc/init.d/mysql启停脚本</li>
</ul>
<h2 id="MySQL配置文件"><a href="#MySQL配置文件" class="headerlink" title="MySQL配置文件"></a>MySQL配置文件</h2><ul>
<li>my-huge.cnf    高端服务器  1-2G内存</li>
<li>my-large.cnf   中等规模</li>
<li>my-medium.cnf  一般</li>
<li>my-small.cnf   较小</li>
</ul>
<p>但是，以上配置文件<code>mysql</code>默认不能识别，默认只能识别<code>/etc/my.cnf</code>，因此需要拷贝一份以上配置文件</p>
<pre><code>[root@192 mysql]# cp /usr/share/mysql/my-huge.cnf /etc/my.cnf</code></pre><p>注意：<code>mysql5.5</code>默认配置文件<code>/etc/my.cnf</code>；<code>Mysql5.6</code>默认配置文件<code>/etc/mysql-default.cnf</code></p>
<h1 id="mysql字符编码"><a href="#mysql字符编码" class="headerlink" title="mysql字符编码"></a>mysql字符编码</h1><h2 id="查看字符编码"><a href="#查看字符编码" class="headerlink" title="查看字符编码"></a>查看字符编码</h2><pre><code>mysql&gt; show variables like &#39;%char%&#39;;
+--------------------------+----------------------------+
| Variable_name            | Value                      |
+--------------------------+----------------------------+
| character_set_client     | utf8                       |
| character_set_connection | utf8                       |
| character_set_database   | latin1                     |
| character_set_filesystem | binary                     |
| character_set_results    | utf8                       |
| character_set_server     | latin1                     |
| character_set_system     | utf8                       |
| character_sets_dir       | /usr/share/mysql/charsets/ |
+--------------------------+----------------------------+
8 rows in set (0.00 sec)
</code></pre><h2 id="安装NPPFTP"><a href="#安装NPPFTP" class="headerlink" title="安装NPPFTP"></a>安装NPPFTP</h2><p>设置—导入—-导入插件</p>
<p><img src="https://raw.githubusercontent.com/shenlibing/blogphoto/master/source/1560301765932.png" alt="1560301765932"></p>
<h2 id="修改字符编码为utf8"><a href="#修改字符编码为utf8" class="headerlink" title="修改字符编码为utf8"></a>修改字符编码为utf8</h2><p>编辑配置文件<code>vim /etc/my.cnf</code>，追加</p>
<pre><code>[mysql]
default-character-set=utf8
[client]
default-character-set=utf8

[mysqld]
character_set_server=utf8
character_set_client=utf8
collation_server=utf8_general_ci</code></pre><p>再次查看字符编码</p>
<pre><code>mysql&gt; show variables like &#39;%char%&#39;;
+--------------------------+----------------------------+
| Variable_name            | Value                      |
+--------------------------+----------------------------+
| character_set_client     | utf8                       |
| character_set_connection | utf8                       |
| character_set_database   | utf8                       |
| character_set_filesystem | binary                     |
| character_set_results    | utf8                       |
| character_set_server     | utf8                       |
| character_set_system     | utf8                       |
| character_sets_dir       | /usr/share/mysql/charsets/ |
+--------------------------+----------------------------+
8 rows in set (0.00 sec)
</code></pre><h2 id="清屏"><a href="#清屏" class="headerlink" title="清屏"></a>清屏</h2><ul>
<li>Ctrl+L</li>
<li>system clear</li>
</ul>
<h1 id="SQL语句查询"><a href="#SQL语句查询" class="headerlink" title="SQL语句查询"></a>SQL语句查询</h1><p><a href="https://www.cnblogs.com/annsshadow/p/5037667.html" target="_blank" rel="noopener">步步深入：MySQL架构总览-&gt;查询执行流程-&gt;SQL解析顺序 - AnnsShadoW - 博客园</a></p>
<h2 id="语法顺序"><a href="#语法顺序" class="headerlink" title="语法顺序"></a>语法顺序</h2><ol>
<li>SELECT</li>
<li>FROM</li>
<li>LEFT JOIN</li>
<li>ON</li>
<li>WHERE</li>
<li>GROUP BY</li>
<li>HAVING</li>
<li>ORDER BY</li>
<li>LIMIT</li>
</ol>
<h2 id="执行顺序"><a href="#执行顺序" class="headerlink" title="执行顺序"></a>执行顺序</h2><pre class=" language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">user</span> <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token keyword">order</span> <span class="token keyword">ON</span> <span class="token keyword">user</span><span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token keyword">order</span><span class="token punctuation">.</span>uid <span class="token keyword">WHERE</span> <span class="token keyword">order</span><span class="token punctuation">.</span>price <span class="token operator">></span> <span class="token number">1000</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">user</span><span class="token punctuation">.</span>name <span class="token keyword">HAVING</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">5</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token keyword">user</span><span class="token punctuation">.</span>name <span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span></code></pre>
<ol>
<li>FROM（将最近的两张表，进行笛卡尔积），得到临时结果集VT1</li>
<li>ON（将VT1按照它的条件进行过滤）—VT2</li>
<li>LEFT JOIN（保留左表的记录）—VT3</li>
<li>WHERE（过滤VT3中的记录）–VT4…VTn</li>
<li>GROUP BY（对VT4的记录进行分组）—VT5</li>
<li>HAVING（对VT5中的记录进行过滤）—VT6</li>
<li>SELECT（对VT6中的记录，选取指定的列）–VT7</li>
<li>ORDER BY（对VT7的记录进行排序）–游标</li>
<li>LIMIT（对排序之后的值进行分页）</li>
</ol>
<h2 id="WHERE条件执行顺序（影响性能）"><a href="#WHERE条件执行顺序（影响性能）" class="headerlink" title="WHERE条件执行顺序（影响性能）"></a>WHERE条件执行顺序（影响性能）</h2><ul>
<li>MYSQL：从左往右去执行WHERE条件的。</li>
<li>Oracle：从右往左去执行WHERE条件的。</li>
</ul>
<p>结论：写WHERE条件的时候，优先级高的部分要去编写过滤力度最大的条件语句。</p>
<p><img src="https://raw.githubusercontent.com/shenlibing/blogphoto/master/source/1560151970456.png" alt="1560151970456"></p>
<h1 id="多表之间关系"><a href="#多表之间关系" class="headerlink" title="多表之间关系"></a>多表之间关系</h1><h2 id="一对一"><a href="#一对一" class="headerlink" title="一对一"></a>一对一</h2><h2 id="一对多"><a href="#一对多" class="headerlink" title="一对多"></a>一对多</h2><p><strong>从表</strong>是：<strong>分类表</strong>。从表中，应该有一个字段去关联主表，而这个关联字段就是<strong>主键</strong>。</p>
<p><strong>主表</strong>是：<strong>商品表</strong>。主表中，应该有一个字段去关联从表，而这个关联字段就是<strong>外键</strong>。</p>
<p><img src="https://raw.githubusercontent.com/shenlibing/blogphoto/master/source/1560045917048.png" alt="1560045917048"></p>
<p> 在互联网项目中，一般情况下，<strong>不建议建立外键关系</strong>。</p>
<h2 id="多对多"><a href="#多对多" class="headerlink" title="多对多"></a>多对多</h2><ul>
<li>双向的一对多</li>
</ul>
<h1 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h1><ul>
<li>存储引擎是针对表的,MySQL 5.5之后，默认的存储引擎由MyISAM变为<strong>InnoDB</strong>。</li>
</ul>
<h2 id="查询数据库支持哪些引擎"><a href="#查询数据库支持哪些引擎" class="headerlink" title="查询数据库支持哪些引擎"></a>查询数据库支持哪些引擎</h2><pre><code>
mysql&gt; show engines;
+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+
| Engine             | Support | Comment                                                        | Transactions | XA   | Savepoints |
+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+
| PERFORMANCE_SCHEMA | YES     | Performance Schema                                             | NO           | NO   | NO         |
| MRG_MYISAM         | YES     | Collection of identical MyISAM tables                          | NO           | NO   | NO         |
| CSV                | YES     | CSV storage engine                                             | NO           | NO   | NO         |
| BLACKHOLE          | YES     | /dev/null storage engine (anything you write to it disappears) | NO           | NO   | NO         |
| MEMORY             | YES     | Hash based, stored in memory, useful for temporary tables      | NO           | NO   | NO         |
| InnoDB             | DEFAULT | Supports transactions, row-level locking, and foreign keys     | YES          | YES  | YES        |
| ARCHIVE            | YES     | Archive storage engine                                         | NO           | NO   | NO         |
| MyISAM             | YES     | MyISAM storage engine                                          | NO           | NO   | NO         |
| FEDERATED          | NO      | Federated MySQL storage engine                                 | NULL         | NULL | NULL       |
+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+
9 rows in set (0.00 sec)
</code></pre><h2 id="查看当前使用的引擎"><a href="#查看当前使用的引擎" class="headerlink" title="查看当前使用的引擎"></a>查看当前使用的引擎</h2><pre><code>mysql&gt; show variables like &#39;%storage_engine%&#39; ;
+------------------------+--------+
| Variable_name          | Value  |
+------------------------+--------+
| default_storage_engine | InnoDB |
| storage_engine         | InnoDB |
+------------------------+--------+
2 rows in set (0.00 sec)
</code></pre><h2 id="指定数据库对象的引擎"><a href="#指定数据库对象的引擎" class="headerlink" title="指定数据库对象的引擎"></a>指定数据库对象的引擎</h2><pre class=" language-sql"><code class="language-sql">    <span class="token keyword">create</span> <span class="token keyword">table</span> tb<span class="token punctuation">(</span>
        id <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">auto_increment</span> <span class="token punctuation">,</span>
        name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        dept <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
        <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>        
    <span class="token punctuation">)</span><span class="token keyword">ENGINE</span><span class="token operator">=</span>MyISAM <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span>
     <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8   <span class="token punctuation">;</span></code></pre>
<h1 id="日志文件、数据文件"><a href="#日志文件、数据文件" class="headerlink" title="日志文件、数据文件"></a>日志文件、数据文件</h1><h2 id="日志位置"><a href="#日志位置" class="headerlink" title="日志位置"></a>日志位置</h2><pre><code>mysql&gt; SHOW  GLOBAL VARIABLES LIKE &#39;%log%&#39;;
+-----------------------------------------+----------------------------------+
| Variable_name                           | Value                            |
+-----------------------------------------+----------------------------------+
| back_log                                | 50                               |
| binlog_cache_size                       | 32768                            |
| binlog_direct_non_transactional_updates | OFF                              |
| binlog_format                           | MIXED                            |
| binlog_stmt_cache_size                  | 32768                            |
| expire_logs_days                        | 0                                |
| general_log                             | OFF                              |
| general_log_file                        | /var/lib/mysql/192.log           |
| innodb_flush_log_at_trx_commit          | 1                                |
| innodb_locks_unsafe_for_binlog          | OFF                              |
| innodb_log_buffer_size                  | 8388608                          |
| innodb_log_file_size                    | 5242880                          |
| innodb_log_files_in_group               | 2                                |
| innodb_log_group_home_dir               | ./                               |
| innodb_mirrored_log_groups              | 1                                |
| log                                     | OFF                              |
| log_bin                                 | ON                               |
| log_bin_trust_function_creators         | OFF                              |
| log_error                               | /var/lib/mysql/192.168.1.101.err |
| log_output                              | FILE                             |
| log_queries_not_using_indexes           | OFF                              |
| log_slave_updates                       | OFF                              |
| log_slow_queries                        | OFF                              |
| log_warnings                            | 1                                |
| max_binlog_cache_size                   | 18446744073709547520             |
| max_binlog_size                         | 1073741824                       |
| max_binlog_stmt_cache_size              | 18446744073709547520             |
| max_relay_log_size                      | 0                                |
| relay_log                               |                                  |
| relay_log_index                         |                                  |
| relay_log_info_file                     | relay-log.info                   |
| relay_log_purge                         | ON                               |
| relay_log_recovery                      | OFF                              |
| relay_log_space_limit                   | 0                                |
| slow_query_log                          | OFF                              |
| slow_query_log_file                     | /var/lib/mysql/192-slow.log      |
| sql_log_bin                             | ON                               |
| sql_log_off                             | OFF                              |
| sync_binlog                             | 0                                |
| sync_relay_log                          | 0                                |
| sync_relay_log_info                     | 0                                |
+-----------------------------------------+----------------------------------+
41 rows in set (0.00 sec)
</code></pre><h3 id="二进制日志"><a href="#二进制日志" class="headerlink" title="二进制日志"></a>二进制日志</h3><ul>
<li>记录了<strong>数据库所有的ddl语句和dml语句</strong>，但不包括select语句内容</li>
<li>用于恢复数据</li>
</ul>
<pre><code>mysql&gt; SHOW VARIABLES LIKE &#39;log_bin%&#39;;
+---------------------------------+-------+
| Variable_name                   | Value |
+---------------------------------+-------+
| log_bin                         | ON    |
| log_bin_trust_function_creators | OFF   |
+---------------------------------+-------+
2 rows in set (0.00 sec)</code></pre><h3 id="错误日志"><a href="#错误日志" class="headerlink" title="错误日志"></a>错误日志</h3><pre><code>mysql&gt;  SHOW VARIABLES LIKE &#39;log_error%&#39;;
+---------------+----------------------------------+
| Variable_name | Value                            |
+---------------+----------------------------------+
| log_error     | /var/lib/mysql/192.168.1.101.err |
+---------------+----------------------------------+
1 row in set (0.00 sec)</code></pre><h3 id="查询日志"><a href="#查询日志" class="headerlink" title="查询日志"></a>查询日志</h3><pre><code>mysql&gt;  SHOW VARIABLES LIKE &#39;general_log%&#39;;
+------------------+------------------------+
| Variable_name    | Value                  |
+------------------+------------------------+
| general_log      | OFF                    |
| general_log_file | /var/lib/mysql/192.log |
+------------------+------------------------+
2 rows in set (0.00 sec)</code></pre><h3 id="慢查询日志"><a href="#慢查询日志" class="headerlink" title="慢查询日志"></a>慢查询日志</h3><pre><code>mysql&gt; SHOW VARIABLES LIKE &#39;slow_query_log%&#39;;
+---------------------+-----------------------------+
| Variable_name       | Value                       |
+---------------------+-----------------------------+
| slow_query_log      | OFF                         |
| slow_query_log_file | /var/lib/mysql/192-slow.log |
+---------------------+-----------------------------+
2 rows in set (0.00 sec)

mysql&gt; SHOW VARIABLES LIKE &#39;long_query_time%&#39;;
+-----------------+-----------+
| Variable_name   | Value     |
+-----------------+-----------+
| long_query_time | 10.000000 |
+-----------------+-----------+
1 row in set (0.00 sec)
</code></pre><h2 id="数据位置"><a href="#数据位置" class="headerlink" title="数据位置"></a>数据位置</h2><pre><code>mysql&gt; SHOW VARIABLES LIKE &#39;%datadir%&#39;;
+---------------+-----------------+
| Variable_name | Value           |
+---------------+-----------------+
| datadir       | /var/lib/mysql/ |
+---------------+-----------------+
1 row in set (0.00 sec)
</code></pre><h1 id="SQL优化"><a href="#SQL优化" class="headerlink" title="SQL优化"></a>SQL优化</h1><p><a href="https://en.wikipedia.org/wiki/B-tree" target="_blank" rel="noopener">B-tree - Wikipedia</a></p>
<p><a href="https://dev.mysql.com/doc/refman/5.5/en/optimization.html" target="_blank" rel="noopener">MySQL :: MySQL 5.5 Reference Manual :: 8 Optimization</a></p>
<p><a href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html" target="_blank" rel="noopener">MySQL索引背后的数据结构及算法原理</a></p>
<p><a href="https://blog.csdn.net/endlu/article/details/51720299" target="_blank" rel="noopener">BTree和B+Tree详解</a></p>
<p>SQL优化， 主要就是 在<strong>优化索引</strong>，索引就 相当于书的目录</p>
<p>索引(index)是帮助MYSQL高效获取数据的数据结构。<strong>索引是数据结构</strong>（树：B树(默认)、Hash树…）</p>
<h2 id="B树索引"><a href="#B树索引" class="headerlink" title="B树索引"></a>B树索引</h2><ul>
<li><code>select * from student where age = 33</code>如果不加索引，从上往下查找需要查找5次，而加了索引，查找的节点处于第三层，所以只需要查找3次</li>
</ul>
<p><img src="https://raw.githubusercontent.com/shenlibing/blogphoto/master/source/1560241574572.png" alt="1560241574572"></p>
<h2 id="B-Tree"><a href="#B-Tree" class="headerlink" title="B+Tree"></a>B+Tree</h2><ul>
<li><code>Btree</code>数据全部放在叶子节点</li>
</ul>
<p><img src="https://raw.githubusercontent.com/shenlibing/blogphoto/master/source/1560241687522.png" alt="1560241687522"></p>
<h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><ul>
<li>主键索引：  不能重复，是一种特殊的唯一索引，不允许有空值</li>
<li>唯一索引  ：不能重复，允许为空值</li>
<li>单值索引  ： 单列， age ;一个表可以多个单值索引,name。</li>
<li>组合索引  ：多个列构成的索引 ，只有在查询条件中使用了这些字段的左边字段时，索引才会被使用，使用组合索引时遵循<strong>最左前缀集合</strong>。</li>
</ul>
<h2 id="创建索引"><a href="#创建索引" class="headerlink" title="创建索引"></a>创建索引</h2><p>如果一个字段是主键<code>primary key</code>，则该字段默认就是主键索引,需要注意的是<code>DDL</code>语句会自动提交,我们不需要手动<code>commit</code></p>
<h3 id="方式一-2"><a href="#方式一-2" class="headerlink" title="方式一"></a>方式一</h3><p><code>create 索引类型  索引名  on 表(字段)</code></p>
<ul>
<li>单值索引</li>
</ul>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span>   dept_index <span class="token keyword">on</span>  tb<span class="token punctuation">(</span>dept<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<ul>
<li>唯一索引</li>
</ul>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">unique</span> <span class="token keyword">index</span>  name_index <span class="token keyword">on</span> tb<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">;</span></code></pre>
<ul>
<li>组合索引</li>
</ul>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> dept_name_index <span class="token keyword">on</span> tb<span class="token punctuation">(</span>dept<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3 id="方式二-2"><a href="#方式二-2" class="headerlink" title="方式二"></a>方式二</h3><p><code>alter table 表名 索引类型  索引名（字段）</code></p>
<ul>
<li>单值索引</li>
</ul>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> tb <span class="token keyword">add</span> <span class="token keyword">index</span> dept_index<span class="token punctuation">(</span>dept<span class="token punctuation">)</span> <span class="token punctuation">;</span></code></pre>
<ul>
<li>唯一索引</li>
</ul>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> tb <span class="token keyword">add</span> <span class="token keyword">unique</span> <span class="token keyword">index</span> name_index<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<ul>
<li>组合索引</li>
</ul>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> tb <span class="token keyword">add</span> <span class="token keyword">index</span> dept_name_index<span class="token punctuation">(</span>dept<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h2 id="删除索引"><a href="#删除索引" class="headerlink" title="删除索引"></a>删除索引</h2><p><code>drop index 索引名 on 表名 ;</code></p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">drop</span> <span class="token keyword">index</span> name_index <span class="token keyword">on</span> tb <span class="token punctuation">;</span></code></pre>
<h2 id="查询索引"><a href="#查询索引" class="headerlink" title="查询索引"></a>查询索引</h2><ul>
<li><code>show index from 表名 ;</code></li>
<li><code>show index from 表名 \G</code></li>
</ul>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">show</span> <span class="token keyword">index</span> <span class="token keyword">from</span> tb<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> <span class="token keyword">Table</span> <span class="token operator">|</span> Non_unique <span class="token operator">|</span> Key_name   <span class="token operator">|</span> Seq_in_index <span class="token operator">|</span> Column_name <span class="token operator">|</span> Collation <span class="token operator">|</span> Cardinality <span class="token operator">|</span> Sub_part <span class="token operator">|</span> Packed <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> Index_type <span class="token operator">|</span> <span class="token keyword">Comment</span> <span class="token operator">|</span> Index_comment <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> tb    <span class="token operator">|</span>          <span class="token number">0</span> <span class="token operator">|</span> <span class="token keyword">PRIMARY</span>    <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> id          <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">0</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span>      <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span> tb    <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> dept_index <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> dept        <span class="token operator">|</span> A         <span class="token operator">|</span>        <span class="token boolean">NULL</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span></code></pre>
<h2 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h2><ul>
<li>提高查询效率（降低IO使用率）</li>
<li>降低CPU使用率 （<code>...order by age desc</code>,因为 B树索引 本身就是一个 好排序的结构，因此在排序时  可以直接使用）</li>
</ul>
<h2 id="弊端"><a href="#弊端" class="headerlink" title="弊端"></a>弊端</h2><ul>
<li>索引本身很大， 可以存放在内存/硬盘（通常为 硬盘）</li>
<li>索引不是所有情况均适用<ul>
<li>少量数据 </li>
<li>频繁更新的字段 </li>
<li>很少使用的字段</li>
</ul>
</li>
<li>索引会降低增删改的效率（增删改  查）</li>
</ul>
<h2 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h2><ul>
<li>尽量创建组合索引（组合索引其实会默认按照最左前缀原则帮我们创建多组索引）</li>
<li>组合索引（id,name,sex）会帮我们创建多组索引—–&gt;[id],[id,name],[id,sex],[id,name,sex],[name,sex]</li>
</ul>
<h1 id="SQL故障排除"><a href="#SQL故障排除" class="headerlink" title="SQL故障排除"></a>SQL故障排除</h1><ul>
<li>慢查询日志:MySQL提供的一种日志记录，用于记录MySQL种响应时间超过阀值的SQL语句 （long_query_time，默认10秒）</li>
<li>慢查询日志默认是关闭的；建议一般开发调优时是打开，而最终部署时关闭。</li>
<li>性能优化思路<ul>
<li>首先需要使用慢查询功能，去获取所有查询时间比较长的SQL语句</li>
<li>其次使用explain命令去查看有问题的SQL的执行计划</li>
<li>最后可以使用show profile[s] 查看有问题的SQL的性能使用情况</li>
</ul>
</li>
</ul>
<h2 id="查看慢查询"><a href="#查看慢查询" class="headerlink" title="查看慢查询"></a>查看慢查询</h2><h3 id="临时开启"><a href="#临时开启" class="headerlink" title="临时开启"></a>临时开启</h3><h4 id="方式一-3"><a href="#方式一-3" class="headerlink" title="方式一"></a>方式一</h4><pre><code>mysql&gt; show variables like &#39;%slow_query_log%&#39; ;
+---------------------+-----------------------------+
| Variable_name       | Value                       |
+---------------------+-----------------------------+
| slow_query_log      | OFF                         |
| slow_query_log_file | /var/lib/mysql/192-slow.log |
+---------------------+-----------------------------+
2 rows in set (0.00 sec)

mysql&gt; set global slow_query_log = ON;
Query OK, 0 rows affected (0.00 sec)

mysql&gt; show variables like &#39;%slow_query_log%&#39; ;
+---------------------+-----------------------------+
| Variable_name       | Value                       |
+---------------------+-----------------------------+
| slow_query_log      | ON                          |
| slow_query_log_file | /var/lib/mysql/192-slow.log |
+---------------------+-----------------------------+
2 rows in set (0.00 sec)

</code></pre><h4 id="方式二-3"><a href="#方式二-3" class="headerlink" title="方式二"></a>方式二</h4><pre><code>mysql&gt; show variables like &#39;%slow_query_log%&#39; ;
+---------------------+-----------------------------+
| Variable_name       | Value                       |
+---------------------+-----------------------------+
| slow_query_log      | OFF                         |
| slow_query_log_file | /var/lib/mysql/192-slow.log |
+---------------------+-----------------------------+
2 rows in set (0.00 sec)

mysql&gt; set global slow_query_log = 1 ;
Query OK, 0 rows affected (0.00 sec)

mysql&gt; show variables like &#39;%slow_query_log%&#39; ;
+---------------------+-----------------------------+
| Variable_name       | Value                       |
+---------------------+-----------------------------+
| slow_query_log      | ON                          |
| slow_query_log_file | /var/lib/mysql/192-slow.log |
+---------------------+-----------------------------+
2 rows in set (0.00 sec)
</code></pre><h3 id="永久开启"><a href="#永久开启" class="headerlink" title="永久开启"></a>永久开启</h3><p>编辑<code>/etc/my.cnf</code> 中追加配置：</p>
<pre><code>vi /etc/my.cnf 
[mysqld]
slow_query_log=1
slow_query_log_file=/var/lib/mysql/localhost-slow.log</code></pre><h3 id="查看慢查询阀值"><a href="#查看慢查询阀值" class="headerlink" title="查看慢查询阀值"></a>查看慢查询阀值</h3><pre><code>mysql&gt; show variables like &#39;%long_query_time%&#39; ;
+-----------------+-----------+
| Variable_name   | Value     |
+-----------------+-----------+
| long_query_time | 10.000000 |
+-----------------+-----------+
1 row in set (0.00 sec)</code></pre><h3 id="临时设置阀值"><a href="#临时设置阀值" class="headerlink" title="临时设置阀值"></a>临时设置阀值</h3><ul>
<li>设置完毕后，重新登陆后起效 （不需要重启服务）</li>
</ul>
<pre><code>mysql&gt; show variables like &#39;%long_query_time%&#39; ;
+-----------------+-----------+
| Variable_name   | Value     |
+-----------------+-----------+
| long_query_time | 10.000000 |
+-----------------+-----------+
1 row in set (0.00 sec)

mysql&gt; set global long_query_time = 5 ;
Query OK, 0 rows affected (0.00 sec)

mysql&gt; show variables like &#39;%long_query_time%&#39; ;
+-----------------+-----------+
| Variable_name   | Value     |
+-----------------+-----------+
| long_query_time | 10.000000 |
+-----------------+-----------+
1 row in set (0.00 sec)

mysql&gt; exit;
Bye
[root@192 ~]# mysql -uroot -p
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 4
Server version: 5.5.48-log MySQL Community Server (GPL)

Copyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.

mysql&gt; show variables like &#39;%long_query_time%&#39; ;
+-----------------+----------+
| Variable_name   | Value    |
+-----------------+----------+
| long_query_time | 5.000000 |
+-----------------+----------+
1 row in set (0.00 sec)
</code></pre><h3 id="永久设置阀值"><a href="#永久设置阀值" class="headerlink" title="永久设置阀值"></a>永久设置阀值</h3><p>编辑<code>/etc/my.cnf</code>中追加配置：</p>
<pre><code>vi /etc/my.cnf 
[mysqld]
long_query_time=3</code></pre><h2 id="查看SQL执行计划"><a href="#查看SQL执行计划" class="headerlink" title="查看SQL执行计划"></a>查看SQL执行计划</h2><p><code>explain +SQL语句</code></p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">explain</span>  <span class="token keyword">select</span>  <span class="token operator">*</span> <span class="token keyword">from</span> tb <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+--------+---------------+------+---------+------+------+---------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span> <span class="token operator">|</span> <span class="token keyword">type</span>   <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>  <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+--------+---------------+------+---------+------+------+---------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> tb    <span class="token operator">|</span> system <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">0</span> <span class="token operator">|</span> const <span class="token keyword">row</span> <span class="token operator">not</span> found <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+--------+---------------+------+---------+------+------+---------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span></code></pre>
<ul>
<li>id : 编号                </li>
<li>select_type ：查询类型</li>
<li>table ：表</li>
<li>type   ：类型</li>
<li>possible_keys ：预测用到的索引 </li>
<li>key  ：实际使用的索引</li>
<li>key_len ：实际使用索引的长度     </li>
<li>ref  :表之间的引用</li>
<li>rows ：通过索引查询到的数据量 </li>
<li>Extra     :额外的信息</li>
</ul>
<h3 id="表结构"><a href="#表结构" class="headerlink" title="表结构"></a>表结构</h3><ul>
<li>课程表<code>(course)</code></li>
<li>教师表<code>(teacher)</code></li>
<li>教师课程描述表<code>(teacherCard)</code></li>
</ul>
<p><img src="https://raw.githubusercontent.com/shenlibing/blogphoto/master/source/1560245341475.png" alt="1560245341475"></p>
<h3 id="准备数据"><a href="#准备数据" class="headerlink" title="准备数据"></a>准备数据</h3><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> course
<span class="token punctuation">(</span>
cid <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
cname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
tid <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> teacher
<span class="token punctuation">(</span>
tid <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
tname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
tcid <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> teacherCard
<span class="token punctuation">(</span>
tcid <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
tcdesc <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">insert</span> <span class="token keyword">into</span> course <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'java'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> course <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'html'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> course <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'sql'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> course <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'web'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> teacher <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'tz'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> teacher <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'tw'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> teacher <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'tl'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> teacherCard <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'tzdesc'</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> teacherCard <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'twdesc'</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> teacherCard <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'tldesc'</span><span class="token punctuation">)</span> <span class="token punctuation">;</span></code></pre>
<h3 id="id"><a href="#id" class="headerlink" title="id"></a>id</h3><h4 id="id值相同"><a href="#id值相同" class="headerlink" title="id值相同"></a>id值相同</h4><ul>
<li><p><code>id</code>值相同，从上往下 顺序执行。</p>
</li>
<li><p>数据小的表优先查询</p>
</li>
<li><p>用<code>wehre</code>连接表之间的关系，表的执行顺序是因数量的个数改变而改变，当教师表新插入3条数据，教师表变成了最后执行的原因是遵循笛卡儿积，尽管<code>3*4*6=72</code>和<code>6*4*3=72</code>最终的条数是一样的，但是它们的中间结果是不一样的，查询<code>3*4=12</code>条效率明显比<code>6*4=24</code>高</p>
</li>
</ul>
<p>查询课程编号为2或教师证编号为3的老师信息</p>
<pre class=" language-sql"><code class="language-sql">
mysql<span class="token operator">></span> <span class="token keyword">EXPLAIN</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> teacher t<span class="token punctuation">,</span>course <span class="token number">c</span><span class="token punctuation">,</span>teacherCard tc <span class="token keyword">where</span> t<span class="token punctuation">.</span>tid<span class="token operator">=</span><span class="token number">c</span><span class="token punctuation">.</span>tid <span class="token operator">and</span> t<span class="token punctuation">.</span>tcid<span class="token operator">=</span>tc<span class="token punctuation">.</span>tcid <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token number">c</span><span class="token punctuation">.</span>cid<span class="token operator">=</span><span class="token number">2</span> <span class="token operator">or</span> tc<span class="token punctuation">.</span>tcid<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span> <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>  <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> t     <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>                                <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> tc    <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">join</span> buffer <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> <span class="token number">c</span>     <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">join</span> buffer <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">insert</span> <span class="token keyword">into</span> teacher <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'ts'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">insert</span> <span class="token keyword">into</span> teacher <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'tw'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">insert</span> <span class="token keyword">into</span> teacher <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'tl'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">EXPLAIN</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> teacher t<span class="token punctuation">,</span>course <span class="token number">c</span><span class="token punctuation">,</span>teacherCard tc <span class="token keyword">where</span> t<span class="token punctuation">.</span>tid<span class="token operator">=</span><span class="token number">c</span><span class="token punctuation">.</span>tid <span class="token operator">and</span> t<span class="token punctuation">.</span>tcid<span class="token operator">=</span>tc<span class="token punctuation">.</span>tcid <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token number">c</span><span class="token punctuation">.</span>cid<span class="token operator">=</span><span class="token number">2</span> <span class="token operator">or</span> tc<span class="token punctuation">.</span>tcid<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span> <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>  <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> tc    <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>                                <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> <span class="token number">c</span>     <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">join</span> buffer <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> t     <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">6</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">join</span> buffer <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<h4 id="id值不同"><a href="#id值不同" class="headerlink" title="id值不同"></a>id值不同</h4><ul>
<li><code>id</code>值越大越优先查询 (本质上在嵌套子查询时，先查内层 再查外层)</li>
</ul>
<p>查询教授SQL课程的老师的描述（desc）</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> tc<span class="token punctuation">.</span>tcdesc <span class="token keyword">from</span> teacherCard tc<span class="token punctuation">,</span>course <span class="token number">c</span><span class="token punctuation">,</span>teacher t <span class="token keyword">where</span> <span class="token number">c</span><span class="token punctuation">.</span>tid <span class="token operator">=</span> t<span class="token punctuation">.</span>tid
    <span class="token operator">-</span><span class="token operator">></span> <span class="token operator">and</span> t<span class="token punctuation">.</span>tcid <span class="token operator">=</span> tc<span class="token punctuation">.</span>tcid <span class="token operator">and</span> <span class="token number">c</span><span class="token punctuation">.</span>cname <span class="token operator">=</span> <span class="token string">'sql'</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span> <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>  <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> tc    <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>                                <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> <span class="token number">c</span>     <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">join</span> buffer <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> t     <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">6</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">join</span> buffer <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> tc<span class="token punctuation">.</span>tcdesc <span class="token keyword">from</span> teacherCard tc <span class="token keyword">where</span> tc<span class="token punctuation">.</span>tcid <span class="token operator">=</span> 
    <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">select</span> t<span class="token punctuation">.</span>tcid <span class="token keyword">from</span> teacher t <span class="token keyword">where</span>  t<span class="token punctuation">.</span>tid <span class="token operator">=</span>  
    <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">c</span><span class="token punctuation">.</span>tid <span class="token keyword">from</span> course <span class="token number">c</span> <span class="token keyword">where</span> <span class="token number">c</span><span class="token punctuation">.</span>cname <span class="token operator">=</span> <span class="token string">'sql'</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span> <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>  <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">PRIMARY</span>     <span class="token operator">|</span> tc    <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> SUBQUERY    <span class="token operator">|</span> t     <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">6</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">3</span> <span class="token operator">|</span> SUBQUERY    <span class="token operator">|</span> <span class="token number">c</span>     <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<h4 id="id值有相同，又有不同"><a href="#id值有相同，又有不同" class="headerlink" title="id值有相同，又有不同"></a>id值有相同，又有不同</h4><ul>
<li>id值越大越优先；id值相同，从上往下 顺序执行</li>
</ul>
<p>子查询+多表</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> t<span class="token punctuation">.</span>tname <span class="token punctuation">,</span>tc<span class="token punctuation">.</span>tcdesc <span class="token keyword">from</span> teacher t<span class="token punctuation">,</span>teacherCard tc <span class="token keyword">where</span> t<span class="token punctuation">.</span>tcid<span class="token operator">=</span> tc<span class="token punctuation">.</span>tcid
    <span class="token operator">-</span><span class="token operator">></span> <span class="token operator">and</span> t<span class="token punctuation">.</span>tid <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">c</span><span class="token punctuation">.</span>tid <span class="token keyword">from</span> course <span class="token number">c</span> <span class="token keyword">where</span> cname <span class="token operator">=</span> <span class="token string">'sql'</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span> <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>  <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">PRIMARY</span>     <span class="token operator">|</span> tc    <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>                                <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">PRIMARY</span>     <span class="token operator">|</span> t     <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">6</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">join</span> buffer <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> SUBQUERY    <span class="token operator">|</span> <span class="token number">c</span>     <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span>                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<h3 id="select-type"><a href="#select-type" class="headerlink" title="select_type"></a>select_type</h3><p>查询类型</p>
<ul>
<li><p>PRIMARY:包含子查询SQL中的 主查询 （最外层）</p>
</li>
<li><p>SUBQUERY：包含子查询SQL中的 子查询 （非最外层）</p>
</li>
<li><p>simple:简单查询（不包含子查询、union）</p>
</li>
<li><p>derived:衍生查询(使用到了临时表)</p>
<ul>
<li><p>在from子查询中只有一张表</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span>  cr<span class="token punctuation">.</span>cname <span class="token keyword">from</span> <span class="token punctuation">(</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> course <span class="token keyword">where</span> tid <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> cr <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+------------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>      <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>  <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+------------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">PRIMARY</span>     <span class="token operator">|</span> <span class="token operator">&lt;</span>derived2<span class="token operator">></span> <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>             <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> DERIVED     <span class="token operator">|</span> course     <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+------------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>在from子查询中， 如果有table1 union table2 ，则table1 就是derived,table2就是union</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span>  cr<span class="token punctuation">.</span>cname <span class="token keyword">from</span> <span class="token punctuation">(</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> course <span class="token keyword">where</span> tid <span class="token operator">=</span> <span class="token number">1</span>  <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> course <span class="token keyword">where</span> tid <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">)</span> cr <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+--------------+------------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type  <span class="token operator">|</span> <span class="token keyword">table</span>      <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>  <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+--------------+------------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">PRIMARY</span>      <span class="token operator">|</span> <span class="token operator">&lt;</span>derived2<span class="token operator">></span> <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>             <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> DERIVED      <span class="token operator">|</span> course     <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">3</span> <span class="token operator">|</span> <span class="token keyword">UNION</span>        <span class="token operator">|</span> course     <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token keyword">UNION</span> RESULT <span class="token operator">|</span> <span class="token operator">&lt;</span>union2<span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">></span> <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+--------------+------------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
</li>
</ul>
<ul>
<li><p>union:上例</p>
</li>
<li><p>union result :告知开发人员，那些表之间存在union查询</p>
</li>
</ul>
<h3 id="type"><a href="#type" class="headerlink" title="type"></a>type</h3><p>索引类型、类型</p>
<ul>
<li>对type进行优化的前提：有索引</li>
</ul>
<p><code>system &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALL</code></p>
<p>比较常见的<code>system&gt;const&gt;eq_ref&gt;ref&gt;range&gt;index&gt;all</code>,其中<code>system,const</code>只是理想情况；实际能达到 的是<code>ref&gt;range</code></p>
<h4 id="system"><a href="#system" class="headerlink" title="system"></a>system</h4><ul>
<li><p>可以忽略: 只有一条数据的系统表 ；或 衍生表只有一条数据的主查询</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">create</span> <span class="token keyword">table</span> test01
    <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">(</span>
    <span class="token operator">-</span><span class="token operator">></span> tid <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token operator">></span> tname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> 
mysql<span class="token operator">></span> <span class="token keyword">insert</span> <span class="token keyword">into</span> test01 <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">commit</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------------+</span>
<span class="token operator">|</span> Tables_in_kkb <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------------+</span>
<span class="token operator">|</span> course        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">lock</span>          <span class="token operator">|</span>
<span class="token operator">|</span> tb            <span class="token operator">|</span>
<span class="token operator">|</span> teacher       <span class="token operator">|</span>
<span class="token operator">|</span> teacherCard   <span class="token operator">|</span>
<span class="token operator">|</span> test01        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">user</span>          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------------+</span>
<span class="token number">7</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">table</span> test01 <span class="token keyword">add</span> <span class="token keyword">constraint</span> tid_pk <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>tid<span class="token punctuation">)</span> <span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">1</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test01 <span class="token punctuation">)</span>t <span class="token keyword">where</span> tid <span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+------------+--------+---------------+------+---------+------+------+-------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>      <span class="token operator">|</span> <span class="token keyword">type</span>   <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>  <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+------------+--------+---------------+------+---------+------+------+-------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">PRIMARY</span>     <span class="token operator">|</span> <span class="token operator">&lt;</span>derived2<span class="token operator">></span> <span class="token operator">|</span> system <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> DERIVED     <span class="token operator">|</span> test01     <span class="token operator">|</span> <span class="token keyword">ALL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+------------+--------+---------------+------+---------+------+------+-------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<h4 id="const"><a href="#const" class="headerlink" title="const"></a>const</h4><p>仅仅能查到一条数据的<code>SQL</code> ,用于<code>Primary key</code>或<code>unique</code>索引 （类型 与索引类型有关）</p>
<pre class=" language-sql"><code class="language-sql">
mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> tid <span class="token keyword">from</span> test01 <span class="token keyword">where</span> tid <span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+---------+---------+-------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span>  <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>     <span class="token operator">|</span> key_len <span class="token operator">|</span> ref   <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+---------+---------+-------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test01 <span class="token operator">|</span> const <span class="token operator">|</span> <span class="token keyword">PRIMARY</span>       <span class="token operator">|</span> <span class="token keyword">PRIMARY</span> <span class="token operator">|</span> <span class="token number">4</span>       <span class="token operator">|</span> const <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">index</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+---------+---------+-------+------+-------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">table</span> test01 <span class="token keyword">drop</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">1</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> tid <span class="token keyword">from</span> test01 <span class="token keyword">where</span> tid <span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>  <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test01 <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">create</span> <span class="token keyword">index</span> test01_index <span class="token keyword">on</span> test01<span class="token punctuation">(</span>tid<span class="token punctuation">)</span> <span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> tid <span class="token keyword">from</span> test01 <span class="token keyword">where</span> tid <span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------------+---------+-------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>          <span class="token operator">|</span> key_len <span class="token operator">|</span> ref   <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------------+---------+-------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test01 <span class="token operator">|</span> ref  <span class="token operator">|</span> test01_index  <span class="token operator">|</span> test01_index <span class="token operator">|</span> <span class="token number">4</span>       <span class="token operator">|</span> const <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">index</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------------+---------+-------+------+-------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<pre><code>
#### eq_ref

唯一性索引：对于每个索引键的查询，返回匹配唯一行数据（有且只有1个，不能多 、不能0）

```sql
mysql&gt; select * from teacher;
+------+-------+------+
| tid  | tname | tcid |
+------+-------+------+
|    1 | tz    |    1 |
|    2 | tw    |    2 |
|    3 | tl    |    3 |
+------+-------+------+
3 rows in set (0.00 sec)

mysql&gt; select * from teacherCard;
+------+--------+
| tcid | tcdesc |
+------+--------+
|    1 | tzdesc |
|    2 | twdesc |
|    3 | tldesc |
+------+--------+
3 rows in set (0.00 sec)

mysql&gt; explain select t.tcid from teacher t,teacherCard tc where t.tcid = tc.tcid ;
+----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+
| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra                          |
+----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+
|  1 | SIMPLE      | t     | ALL  | NULL          | NULL | NULL    | NULL |    3 |                                |
|  1 | SIMPLE      | tc    | ALL  | NULL          | NULL | NULL    | NULL |    3 | Using where; Using join buffer |
+----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+
2 rows in set (0.00 sec)

mysql&gt; alter table teacherCard add constraint pk_tcid primary key(tcid);
Query OK, 0 rows affected (0.02 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; alter table teacher add constraint uk_tcid unique index(tcid) ;
Query OK, 0 rows affected (0.02 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; explain select t.tcid from teacher t,teacherCard tc where t.tcid = tc.tcid ;
+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+
| id | select_type | table | type   | possible_keys | key     | key_len | ref        | rows | Extra       |
+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+
|  1 | SIMPLE      | t     | index  | uk_tcid       | uk_tcid | 5       | NULL       |    3 | Using index |
|  1 | SIMPLE      | tc    | eq_ref | PRIMARY       | PRIMARY | 4       | kkb.t.tcid |    1 | Using index |
+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+
2 rows in set (0.00 sec)
</code></pre></li>
</ul>
<pre><code>
  以上`SQL`，用到的索引是 `t.tcid`,即`teacher`表中的`tcid`字段；
  如果`teacher`表的数据个数 和 连接查询的数据个数一致（都是3条数据），则有可能满足`eq_ref`级别；否则无法满足。

#### ref

非唯一性索引，对于每个索引键的查询，返回匹配的所有行（0行或者多行）

```sql
mysql&gt; insert into teacher values(4,&#39;tz&#39;,4) ;
Query OK, 1 row affected (0.00 sec)

mysql&gt;  insert into teacherCard values(4,&#39;tz222&#39;);
Query OK, 1 row affected (0.00 sec)

mysql&gt; select * from teacher;
+------+-------+------+
| tid  | tname | tcid |
+------+-------+------+
|    1 | tz    |    1 |
|    2 | tw    |    2 |
|    3 | tl    |    3 |
|    4 | tz    |    4 |
+------+-------+------+
4 rows in set (0.00 sec)

mysql&gt; select * from teacherCard;
+------+--------+
| tcid | tcdesc |
+------+--------+
|    1 | tzdesc |
|    2 | twdesc |
|    3 | tldesc |
|    4 | tz222  |
+------+--------+
4 rows in set (0.00 sec)

mysql&gt; alter table teacher add index index_name (tname) ;
Query OK, 0 rows affected (0.02 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; explain select * from teacher where tname = &#39;tz&#39;;
+----+-------------+---------+------+---------------+------------+---------+-------+------+-------------+
| id | select_type | table   | type | possible_keys | key        | key_len | ref   | rows | Extra       |
+----+-------------+---------+------+---------------+------------+---------+-------+------+-------------+
|  1 | SIMPLE      | teacher | ref  | index_name    | index_name | 63      | const |    2 | Using where |
+----+-------------+---------+------+---------------+------------+---------+-------+------+-------------+
1 row in set (0.00 sec)
</code></pre><h4 id="range"><a href="#range" class="headerlink" title="range"></a>range</h4><p>检索指定范围的行 ,<code>where</code>后面是一个范围查询</p>
<ul>
<li>between</li>
<li>&lt; &gt;=    </li>
<li>特殊的情况，<code>in</code>有时候会失效 ，从而转为 无索引，进行全表扫描<code>all</code>)</li>
</ul>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">table</span> teacher <span class="token keyword">add</span> <span class="token keyword">index</span> tid_index <span class="token punctuation">(</span>tid<span class="token punctuation">)</span> <span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> teacher<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token operator">|</span> tid  <span class="token operator">|</span> tname <span class="token operator">|</span> tcid <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> tz    <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span> tw    <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> tl    <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> tz    <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">show</span> <span class="token keyword">index</span> <span class="token keyword">from</span> teacher<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> <span class="token keyword">Table</span>   <span class="token operator">|</span> Non_unique <span class="token operator">|</span> Key_name   <span class="token operator">|</span> Seq_in_index <span class="token operator">|</span> Column_name <span class="token operator">|</span> Collation <span class="token operator">|</span> Cardinality <span class="token operator">|</span> Sub_part <span class="token operator">|</span> Packed <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> Index_type <span class="token operator">|</span> <span class="token keyword">Comment</span> <span class="token operator">|</span> Index_comment <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> teacher <span class="token operator">|</span>          <span class="token number">0</span> <span class="token operator">|</span> uk_tcid    <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> tcid        <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">4</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span> teacher <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> index_name <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> tname       <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">4</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span> teacher <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> tid_index  <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> tid         <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">4</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> t<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> teacher t <span class="token keyword">where</span> t<span class="token punctuation">.</span>tid <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span> <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>  <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> t     <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> tid_index     <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> t<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> teacher t <span class="token keyword">where</span> t<span class="token punctuation">.</span>tid <span class="token operator">&lt;</span><span class="token number">3</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+-------+---------------+-----------+---------+------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span> <span class="token operator">|</span> <span class="token keyword">type</span>  <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>       <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+-------+---------------+-----------+---------+------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> t     <span class="token operator">|</span> range <span class="token operator">|</span> tid_index     <span class="token operator">|</span> tid_index <span class="token operator">|</span> <span class="token number">5</span>       <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+-------+---------------+-----------+---------+------+------+-------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<h4 id="index"><a href="#index" class="headerlink" title="index"></a>index</h4><p>查询全部索引中数据，<code>tid</code> 是索引， 只需要扫描索引表，不需要所有表中的所有数据</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">show</span> <span class="token keyword">index</span> <span class="token keyword">from</span> teacher<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> <span class="token keyword">Table</span>   <span class="token operator">|</span> Non_unique <span class="token operator">|</span> Key_name   <span class="token operator">|</span> Seq_in_index <span class="token operator">|</span> Column_name <span class="token operator">|</span> Collation <span class="token operator">|</span> Cardinality <span class="token operator">|</span> Sub_part <span class="token operator">|</span> Packed <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> Index_type <span class="token operator">|</span> <span class="token keyword">Comment</span> <span class="token operator">|</span> Index_comment <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> teacher <span class="token operator">|</span>          <span class="token number">0</span> <span class="token operator">|</span> uk_tcid    <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> tcid        <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">4</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span> teacher <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> index_name <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> tname       <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">4</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span> teacher <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> tid_index  <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> tid         <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">4</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> teacher<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token operator">|</span> tid  <span class="token operator">|</span> tname <span class="token operator">|</span> tcid <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> tz    <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span> tw    <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> tl    <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> tz    <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> tid <span class="token keyword">from</span> teacher<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+-------+---------------+-----------+---------+------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>   <span class="token operator">|</span> <span class="token keyword">type</span>  <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>       <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+-------+---------------+-----------+---------+------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> teacher <span class="token operator">|</span> <span class="token keyword">index</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> tid_index <span class="token operator">|</span> <span class="token number">5</span>       <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">index</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+-------+---------------+-----------+---------+------+------+-------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<h4 id="all"><a href="#all" class="headerlink" title="all"></a>all</h4><p>查询全部表中的数据</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">show</span> <span class="token keyword">index</span> <span class="token keyword">from</span> course<span class="token punctuation">;</span>
Empty <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> course<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token operator">|</span> cid  <span class="token operator">|</span> cname <span class="token operator">|</span> tid  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> java  <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span> html  <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> sql   <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> web   <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> course<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+------+---------+------+------+-------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>  <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+------+---------+------+------+-------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> course <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+------+---------+------+------+-------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<h3 id="possible-keys"><a href="#possible-keys" class="headerlink" title="possible_keys"></a>possible_keys</h3><p>可能用到的索引，是一种预测，不准</p>
<pre><code>mysql&gt; alter table  course add index cname_index (cname);
Query OK, 0 rows affected (0.04 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; select * from course;
+------+-------+------+
| cid  | cname | tid  |
+------+-------+------+
|    1 | java  |    1 |
|    2 | html  |    1 |
|    3 | sql   |    2 |
|    4 | web   |    3 |
+------+-------+------+
4 rows in set (0.00 sec)

mysql&gt; show index from course;
+--------+------------+-------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| Table  | Non_unique | Key_name    | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |
+--------+------------+-------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| course |          1 | cname_index |            1 | cname       | A         |           4 |     NULL | NULL   | YES  | BTREE      |         |               |
+--------+------------+-------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
1 row in set (0.00 sec)

mysql&gt; show index from teacher;
+---------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| Table   | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |
+---------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| teacher |          0 | uk_tcid    |            1 | tcid        | A         |           4 |     NULL | NULL   | YES  | BTREE      |         |               |
| teacher |          1 | index_name |            1 | tname       | A         |           4 |     NULL | NULL   | YES  | BTREE      |         |               |
| teacher |          1 | tid_index  |            1 | tid         | A         |           4 |     NULL | NULL   | YES  | BTREE      |         |               |
+---------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
3 rows in set (0.00 sec)

mysql&gt; show index from teacherCard;
+-------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| Table       | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |
+-------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| teacherCard |          0 | PRIMARY  |            1 | tcid        | A         |           4 |     NULL | NULL   |      | BTREE      |         |               |
+-------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
1 row in set (0.00 sec)

mysql&gt; explain select t.tname ,tc.tcdesc from teacher t,teacherCard tc
    -&gt;  where t.tcid= tc.tcid
    -&gt; and t.tid = (select c.tid from course c where cname = &#39;sql&#39;) ;
+----+-------------+-------+--------+-------------------+-------------+---------+------------+------+-------------+
| id | select_type | table | type   | possible_keys     | key         | key_len | ref        | rows | Extra       |
+----+-------------+-------+--------+-------------------+-------------+---------+------------+------+-------------+
|  1 | PRIMARY     | t     | ref    | uk_tcid,tid_index | tid_index   | 5       | const      |    1 | Using where |
|  1 | PRIMARY     | tc    | eq_ref | PRIMARY           | PRIMARY     | 4       | kkb.t.tcid |    1 |             |
|  2 | SUBQUERY    | c     | ref    | cname_index       | cname_index | 63      |            |    1 | Using where |
+----+-------------+-------+--------+-------------------+-------------+---------+------------+------+-------------+
3 rows in set (0.00 sec)
</code></pre><p>如果 <code>possible_key/key</code>是<code>NULL</code>，则说明没用索引</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> tc<span class="token punctuation">.</span>tcdesc <span class="token keyword">from</span> teacherCard tc<span class="token punctuation">,</span>course <span class="token number">c</span><span class="token punctuation">,</span>teacher t <span class="token keyword">where</span> <span class="token number">c</span><span class="token punctuation">.</span>tid <span class="token operator">=</span> t<span class="token punctuation">.</span>tid
    <span class="token operator">-</span><span class="token operator">></span> <span class="token operator">and</span> t<span class="token punctuation">.</span>tcid <span class="token operator">=</span> tc<span class="token punctuation">.</span>tcid <span class="token operator">and</span> <span class="token number">c</span><span class="token punctuation">.</span>cname <span class="token operator">=</span> <span class="token string">'sql'</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+--------+-------------------+-------------+---------+------------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span> <span class="token operator">|</span> <span class="token keyword">type</span>   <span class="token operator">|</span> possible_keys     <span class="token operator">|</span> <span class="token keyword">key</span>         <span class="token operator">|</span> key_len <span class="token operator">|</span> ref        <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+--------+-------------------+-------------+---------+------------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> <span class="token number">c</span>     <span class="token operator">|</span> ref    <span class="token operator">|</span> cname_index       <span class="token operator">|</span> cname_index <span class="token operator">|</span> <span class="token number">63</span>      <span class="token operator">|</span> const      <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> t     <span class="token operator">|</span> ref    <span class="token operator">|</span> uk_tcid<span class="token punctuation">,</span>tid_index <span class="token operator">|</span> tid_index   <span class="token operator">|</span> <span class="token number">5</span>       <span class="token operator">|</span> kkb<span class="token number">.c</span><span class="token punctuation">.</span>tid  <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> tc    <span class="token operator">|</span> eq_ref <span class="token operator">|</span> <span class="token keyword">PRIMARY</span>           <span class="token operator">|</span> <span class="token keyword">PRIMARY</span>     <span class="token operator">|</span> <span class="token number">4</span>       <span class="token operator">|</span> kkb<span class="token punctuation">.</span>t<span class="token punctuation">.</span>tcid <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+--------+-------------------+-------------+---------+------------+------+-------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">drop</span> <span class="token keyword">index</span> cname_index <span class="token keyword">on</span> course<span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> tc<span class="token punctuation">.</span>tcdesc <span class="token keyword">from</span> teacherCard tc<span class="token punctuation">,</span>course <span class="token number">c</span><span class="token punctuation">,</span>teacher t <span class="token keyword">where</span> <span class="token number">c</span><span class="token punctuation">.</span>tid <span class="token operator">=</span> t<span class="token punctuation">.</span>tid <span class="token operator">and</span> t<span class="token punctuation">.</span>tcid <span class="token operator">=</span> tc<span class="token punctuation">.</span>tcid <span class="token operator">and</span> <span class="token number">c</span><span class="token punctuation">.</span>cname <span class="token operator">=</span> <span class="token string">'sql'</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+--------+-------------------+---------+---------+------------+------+--------------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span> <span class="token operator">|</span> <span class="token keyword">type</span>   <span class="token operator">|</span> possible_keys     <span class="token operator">|</span> <span class="token keyword">key</span>     <span class="token operator">|</span> key_len <span class="token operator">|</span> ref        <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+--------+-------------------+---------+---------+------------+------+--------------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> <span class="token number">c</span>     <span class="token operator">|</span> <span class="token keyword">ALL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span>              <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span>       <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span>                    <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> t     <span class="token operator">|</span> <span class="token keyword">ALL</span>    <span class="token operator">|</span> uk_tcid<span class="token punctuation">,</span>tid_index <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span>       <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">join</span> buffer <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> tc    <span class="token operator">|</span> eq_ref <span class="token operator">|</span> <span class="token keyword">PRIMARY</span>           <span class="token operator">|</span> <span class="token keyword">PRIMARY</span> <span class="token operator">|</span> <span class="token number">4</span>       <span class="token operator">|</span> kkb<span class="token punctuation">.</span>t<span class="token punctuation">.</span>tcid <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>                                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+--------+-------------------+---------+---------+------------+------+--------------------------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<h3 id="key"><a href="#key" class="headerlink" title="key"></a>key</h3><p>实际使用到的索引</p>
<h3 id="key-len"><a href="#key-len" class="headerlink" title="key_len"></a>key_len</h3><ul>
<li>utf8:1个字符3个字节</li>
<li>gbk:1个字符2个字节</li>
<li>latin:1个字符1个字节</li>
</ul>
<p>索引的长度, 用于判断复合索引是否被完全使用,<code>key_len为60，在utf8：1个字符占3个字节</code></p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">create</span> <span class="token keyword">table</span> test_kl
    <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">(</span>
    <span class="token operator">-</span><span class="token operator">></span> name char<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">default</span> <span class="token string">''</span>
    <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">table</span> test_kl <span class="token keyword">add</span> <span class="token keyword">index</span> index_name<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test_kl <span class="token keyword">where</span> name <span class="token operator">=</span><span class="token string">''</span> <span class="token punctuation">;</span> 
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+------+---------------+------------+---------+-------+------+--------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>   <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>        <span class="token operator">|</span> key_len <span class="token operator">|</span> ref   <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+------+---------------+------------+---------+-------+------+--------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test_kl <span class="token operator">|</span> ref  <span class="token operator">|</span> index_name    <span class="token operator">|</span> index_name <span class="token operator">|</span> <span class="token number">60</span>      <span class="token operator">|</span> const <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">index</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+------+---------------+------------+---------+-------+------+--------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
</code></pre>
<p>如果索引字段可以为<code>Null</code>,则会使用1个字节用于标识。因此<code>key_len为61</code></p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">table</span> test_kl <span class="token keyword">add</span> <span class="token keyword">column</span> name1 char<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">table</span> test_kl <span class="token keyword">add</span> <span class="token keyword">index</span> index_name1<span class="token punctuation">(</span>name1<span class="token punctuation">)</span> <span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test_kl <span class="token keyword">where</span> name1 <span class="token operator">=</span><span class="token string">''</span> <span class="token punctuation">;</span> 
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+------+---------------+-------------+---------+-------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>   <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>         <span class="token operator">|</span> key_len <span class="token operator">|</span> ref   <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+------+---------------+-------------+---------+-------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test_kl <span class="token operator">|</span> ref  <span class="token operator">|</span> index_name1   <span class="token operator">|</span> index_name1 <span class="token operator">|</span> <span class="token number">61</span>      <span class="token operator">|</span> const <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+------+---------------+-------------+---------+-------+------+-------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<p>增加一个复合索引 ,根据最左前缀原则，两次<code>key_len</code>分别为121和60</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">drop</span> <span class="token keyword">index</span> index_name <span class="token keyword">on</span> test_kl <span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">drop</span> <span class="token keyword">index</span> index_name1 <span class="token keyword">on</span> test_kl <span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">table</span> test_kl <span class="token keyword">add</span> <span class="token keyword">index</span> name_name1_index <span class="token punctuation">(</span>name<span class="token punctuation">,</span>name1<span class="token punctuation">)</span> <span class="token punctuation">;</span> 
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">show</span> <span class="token keyword">index</span> <span class="token keyword">from</span> test_kl<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+------------+------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> <span class="token keyword">Table</span>   <span class="token operator">|</span> Non_unique <span class="token operator">|</span> Key_name         <span class="token operator">|</span> Seq_in_index <span class="token operator">|</span> Column_name <span class="token operator">|</span> Collation <span class="token operator">|</span> Cardinality <span class="token operator">|</span> Sub_part <span class="token operator">|</span> Packed <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> Index_type <span class="token operator">|</span> <span class="token keyword">Comment</span> <span class="token operator">|</span> Index_comment <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+------------+------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> test_kl <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> name_name1_index <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> name        <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">0</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span>      <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span> test_kl <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> name_name1_index <span class="token operator">|</span>            <span class="token number">2</span> <span class="token operator">|</span> name1       <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">0</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+------------+------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test_kl <span class="token keyword">where</span> name1 <span class="token operator">=</span> <span class="token string">''</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+-------+---------------+------------------+---------+------+------+--------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>   <span class="token operator">|</span> <span class="token keyword">type</span>  <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>              <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+-------+---------------+------------------+---------+------+------+--------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test_kl <span class="token operator">|</span> <span class="token keyword">index</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> name_name1_index <span class="token operator">|</span> <span class="token number">121</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">index</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+-------+---------------+------------------+---------+------+------+--------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test_kl <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">''</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+------+------------------+------------------+---------+-------+------+--------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>   <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys    <span class="token operator">|</span> <span class="token keyword">key</span>              <span class="token operator">|</span> key_len <span class="token operator">|</span> ref   <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+------+------------------+------------------+---------+-------+------+--------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test_kl <span class="token operator">|</span> ref  <span class="token operator">|</span> name_name1_index <span class="token operator">|</span> name_name1_index <span class="token operator">|</span> <span class="token number">60</span>      <span class="token operator">|</span> const <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">index</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+------+------------------+------------------+---------+-------+------+--------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>


</code></pre>
<p>索引字段为可变<code>varchar</code>类型,用2个字节 标识可变长度,1字节标识Null,因此<code>20*3=60 +  1(null)  +2(用2个字节 标识可变长度)  =63</code></p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">table</span> test_kl <span class="token keyword">add</span> <span class="token keyword">column</span> name2 <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> 
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">table</span> test_kl <span class="token keyword">add</span> <span class="token keyword">index</span> name2_index <span class="token punctuation">(</span>name2<span class="token punctuation">)</span> <span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test_kl <span class="token keyword">where</span> name2 <span class="token operator">=</span> <span class="token string">''</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+------+---------------+-------------+---------+-------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>   <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>         <span class="token operator">|</span> key_len <span class="token operator">|</span> ref   <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+------+---------------+-------------+---------+-------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test_kl <span class="token operator">|</span> ref  <span class="token operator">|</span> name2_index   <span class="token operator">|</span> name2_index <span class="token operator">|</span> <span class="token number">63</span>      <span class="token operator">|</span> const <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+---------+------+---------------+-------------+---------+-------+------+-------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<h3 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h3><p>表之间的引用，注意与<code>type</code>中的<code>ref</code>值区分</p>
<p>指明当前表所参照的字段<code>select ....where a.c = b.x ;(其中b.x可以是常量，const)</code></p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">desc</span> course<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+-------------+------+-----+---------+-------+</span>
<span class="token operator">|</span> Field <span class="token operator">|</span> <span class="token keyword">Type</span>        <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> <span class="token keyword">Key</span> <span class="token operator">|</span> <span class="token keyword">Default</span> <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+-------------+------+-----+---------+-------+</span>
<span class="token operator">|</span> cid   <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>      <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> cname <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> tid   <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>      <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+-------------+------+-----+---------+-------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">table</span> course  <span class="token keyword">add</span> <span class="token keyword">index</span> tid_index <span class="token punctuation">(</span>tid<span class="token punctuation">)</span> <span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.04</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> course <span class="token number">c</span><span class="token punctuation">,</span>teacher t <span class="token keyword">where</span> <span class="token number">c</span><span class="token punctuation">.</span>tid <span class="token operator">=</span> t<span class="token punctuation">.</span>tid  <span class="token operator">and</span> t<span class="token punctuation">.</span>tname <span class="token operator">=</span><span class="token string">'tw'</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+----------------------+------------+---------+-----------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span> <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys        <span class="token operator">|</span> <span class="token keyword">key</span>        <span class="token operator">|</span> key_len <span class="token operator">|</span> ref       <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+----------------------+------------+---------+-----------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> t     <span class="token operator">|</span> ref  <span class="token operator">|</span> index_name<span class="token punctuation">,</span>tid_index <span class="token operator">|</span> index_name <span class="token operator">|</span> <span class="token number">63</span>      <span class="token operator">|</span> const     <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> <span class="token number">c</span>     <span class="token operator">|</span> ref  <span class="token operator">|</span> tid_index            <span class="token operator">|</span> tid_index  <span class="token operator">|</span> <span class="token number">5</span>       <span class="token operator">|</span> kkb<span class="token punctuation">.</span>t<span class="token punctuation">.</span>tid <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+----------------------+------------+---------+-----------+------+-------------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<h3 id="rows"><a href="#rows" class="headerlink" title="rows"></a>rows</h3><p>被索引优化查询的 数据个数 (实际通过索引而查询到的 数据个数)</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> course<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token operator">|</span> cid  <span class="token operator">|</span> cname <span class="token operator">|</span> tid  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> java  <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span> html  <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> sql   <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> web   <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> teacher<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token operator">|</span> tid  <span class="token operator">|</span> tname <span class="token operator">|</span> tcid <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> tz    <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span> tw    <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> tl    <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> tz    <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+</span>
<span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">show</span> <span class="token keyword">index</span> <span class="token keyword">from</span> course<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">--------+------------+-----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> <span class="token keyword">Table</span>  <span class="token operator">|</span> Non_unique <span class="token operator">|</span> Key_name  <span class="token operator">|</span> Seq_in_index <span class="token operator">|</span> Column_name <span class="token operator">|</span> Collation <span class="token operator">|</span> Cardinality <span class="token operator">|</span> Sub_part <span class="token operator">|</span> Packed <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> Index_type <span class="token operator">|</span> <span class="token keyword">Comment</span> <span class="token operator">|</span> Index_comment <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">--------+------------+-----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> course <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> tid_index <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> tid         <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">4</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">--------+------------+-----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">show</span> <span class="token keyword">index</span> <span class="token keyword">from</span> teacher<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> <span class="token keyword">Table</span>   <span class="token operator">|</span> Non_unique <span class="token operator">|</span> Key_name   <span class="token operator">|</span> Seq_in_index <span class="token operator">|</span> Column_name <span class="token operator">|</span> Collation <span class="token operator">|</span> Cardinality <span class="token operator">|</span> Sub_part <span class="token operator">|</span> Packed <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> Index_type <span class="token operator">|</span> <span class="token keyword">Comment</span> <span class="token operator">|</span> Index_comment <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> teacher <span class="token operator">|</span>          <span class="token number">0</span> <span class="token operator">|</span> uk_tcid    <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> tcid        <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">4</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span> teacher <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> index_name <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> tname       <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">4</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span> teacher <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> tid_index  <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> tid         <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">4</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> course <span class="token number">c</span><span class="token punctuation">,</span>teacher t  <span class="token keyword">where</span> <span class="token number">c</span><span class="token punctuation">.</span>tid <span class="token operator">=</span> t<span class="token punctuation">.</span>tid <span class="token operator">and</span> t<span class="token punctuation">.</span>tname <span class="token operator">=</span> <span class="token string">'tz'</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+------+-------+------+</span>
<span class="token operator">|</span> cid  <span class="token operator">|</span> cname <span class="token operator">|</span> tid  <span class="token operator">|</span> tid  <span class="token operator">|</span> tname <span class="token operator">|</span> tcid <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+------+-------+------+</span>
<span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> java  <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> tz    <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span> html  <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> tz    <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+-------+------+------+-------+------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> course <span class="token number">c</span><span class="token punctuation">,</span>teacher t  <span class="token keyword">where</span> <span class="token number">c</span><span class="token punctuation">.</span>tid <span class="token operator">=</span> t<span class="token punctuation">.</span>tid <span class="token operator">and</span> t<span class="token punctuation">.</span>tname <span class="token operator">=</span> <span class="token string">'tz'</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+----------------------+------------+---------+-----------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span> <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys        <span class="token operator">|</span> <span class="token keyword">key</span>        <span class="token operator">|</span> key_len <span class="token operator">|</span> ref       <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+----------------------+------------+---------+-----------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> t     <span class="token operator">|</span> ref  <span class="token operator">|</span> index_name<span class="token punctuation">,</span>tid_index <span class="token operator">|</span> index_name <span class="token operator">|</span> <span class="token number">63</span>      <span class="token operator">|</span> const     <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> <span class="token number">c</span>     <span class="token operator">|</span> ref  <span class="token operator">|</span> tid_index            <span class="token operator">|</span> tid_index  <span class="token operator">|</span> <span class="token number">5</span>       <span class="token operator">|</span> kkb<span class="token punctuation">.</span>t<span class="token punctuation">.</span>tid <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+-------+------+----------------------+------------+---------+-----------+------+-------------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<h3 id="Extra"><a href="#Extra" class="headerlink" title="Extra"></a>Extra</h3><h4 id="using-filesort"><a href="#using-filesort" class="headerlink" title="using filesort"></a>using filesort</h4><p><code>using filesort</code> ： 性能消耗大；需要“额外”的一次排序（查询）  。常见于 <code>order by</code> 语句中。</p>
<p>对于单索引， 如果排序和查找是同一个字段，则不会出现<code>using filesort</code>；如果排序和查找不是同一个字段，则会出现<code>using filesort</code>；，平常使用的话，<code>where</code>哪些字段，就<code>order by</code>那些字段</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">create</span> <span class="token keyword">table</span> test02
    <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">(</span>
    <span class="token operator">-</span><span class="token operator">></span> <span class="token number">a1</span> char<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token operator">></span> <span class="token number">a2</span> char<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token operator">></span> <span class="token number">a3</span> char<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token operator">></span> <span class="token keyword">index</span> idx_a1<span class="token punctuation">(</span><span class="token number">a1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token operator">></span> <span class="token keyword">index</span> idx_a2<span class="token punctuation">(</span><span class="token number">a2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token operator">></span> <span class="token keyword">index</span> idx_a3<span class="token punctuation">(</span><span class="token number">a3</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test02 <span class="token keyword">where</span> <span class="token number">a1</span> <span class="token operator">=</span><span class="token string">''</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">a1</span> <span class="token punctuation">;</span>
Empty <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test02 <span class="token keyword">where</span> <span class="token number">a1</span> <span class="token operator">=</span><span class="token string">''</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">a1</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------+---------+-------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>    <span class="token operator">|</span> key_len <span class="token operator">|</span> ref   <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------+---------+-------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test02 <span class="token operator">|</span> ref  <span class="token operator">|</span> idx_a1        <span class="token operator">|</span> idx_a1 <span class="token operator">|</span> <span class="token number">10</span>      <span class="token operator">|</span> const <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------+---------+-------+------+-------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test02 <span class="token keyword">where</span> <span class="token number">a1</span> <span class="token operator">=</span><span class="token string">''</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">a2</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------+---------+-------+------+-----------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>    <span class="token operator">|</span> key_len <span class="token operator">|</span> ref   <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------+---------+-------+------+-----------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test02 <span class="token operator">|</span> ref  <span class="token operator">|</span> idx_a1        <span class="token operator">|</span> idx_a1 <span class="token operator">|</span> <span class="token number">10</span>      <span class="token operator">|</span> const <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> filesort <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------+---------+-------+------+-----------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<p>复合索引：不能跨列（最佳左前缀），<code>where和order by</code>按照复合索引的顺序使用，不要跨列或无序使用。</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">drop</span> <span class="token keyword">index</span> idx_a1 <span class="token keyword">on</span> test02<span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">drop</span> <span class="token keyword">index</span> idx_a2 <span class="token keyword">on</span> test02<span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">drop</span> <span class="token keyword">index</span> idx_a3 <span class="token keyword">on</span> test02<span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> 
mysql<span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">table</span> test02 <span class="token keyword">add</span> <span class="token keyword">index</span> idx_a1_a2_a3 <span class="token punctuation">(</span><span class="token number">a1</span><span class="token punctuation">,</span><span class="token number">a2</span><span class="token punctuation">,</span><span class="token number">a3</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">show</span> <span class="token keyword">index</span> <span class="token keyword">from</span> test02<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">--------+------------+--------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> <span class="token keyword">Table</span>  <span class="token operator">|</span> Non_unique <span class="token operator">|</span> Key_name     <span class="token operator">|</span> Seq_in_index <span class="token operator">|</span> Column_name <span class="token operator">|</span> Collation <span class="token operator">|</span> Cardinality <span class="token operator">|</span> Sub_part <span class="token operator">|</span> Packed <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> Index_type <span class="token operator">|</span> <span class="token keyword">Comment</span> <span class="token operator">|</span> Index_comment <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">--------+------------+--------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> test02 <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> idx_a1_a2_a3 <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> <span class="token number">a1</span>          <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">0</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span> test02 <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> idx_a1_a2_a3 <span class="token operator">|</span>            <span class="token number">2</span> <span class="token operator">|</span> <span class="token number">a2</span>          <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">0</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span> test02 <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> idx_a1_a2_a3 <span class="token operator">|</span>            <span class="token number">3</span> <span class="token operator">|</span> <span class="token number">a3</span>          <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">0</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">--------+------------+--------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span><span class="token keyword">from</span> test02 <span class="token keyword">where</span> <span class="token number">a1</span><span class="token operator">=</span><span class="token string">''</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">a3</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------------+---------+-------+------+------------------------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>          <span class="token operator">|</span> key_len <span class="token operator">|</span> ref   <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------------+---------+-------+------+------------------------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test02 <span class="token operator">|</span> ref  <span class="token operator">|</span> idx_a1_a2_a3  <span class="token operator">|</span> idx_a1_a2_a3 <span class="token operator">|</span> <span class="token number">10</span>      <span class="token operator">|</span> const <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">index</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> filesort <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------------+---------+-------+------+------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span><span class="token keyword">from</span> test02 <span class="token keyword">where</span> <span class="token number">a2</span><span class="token operator">=</span><span class="token string">''</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">a3</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+------------------------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span>  <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>          <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+------------------------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test02 <span class="token operator">|</span> <span class="token keyword">index</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> idx_a1_a2_a3 <span class="token operator">|</span> <span class="token number">30</span>      <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">index</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> filesort <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span><span class="token keyword">from</span> test02 <span class="token keyword">where</span> <span class="token number">a1</span><span class="token operator">=</span><span class="token string">''</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">a2</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------------+---------+-------+------+--------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>          <span class="token operator">|</span> key_len <span class="token operator">|</span> ref   <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------------+---------+-------+------+--------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test02 <span class="token operator">|</span> ref  <span class="token operator">|</span> idx_a1_a2_a3  <span class="token operator">|</span> idx_a1_a2_a3 <span class="token operator">|</span> <span class="token number">10</span>      <span class="token operator">|</span> const <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">index</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+--------------+---------+-------+------+--------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span><span class="token keyword">from</span> test02 <span class="token keyword">where</span> <span class="token number">a2</span><span class="token operator">=</span><span class="token string">''</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">a1</span> <span class="token punctuation">;</span> 
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+--------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span>  <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>          <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+--------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test02 <span class="token operator">|</span> <span class="token keyword">index</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> idx_a1_a2_a3 <span class="token operator">|</span> <span class="token number">30</span>      <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">index</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+--------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<h4 id="using-temporary"><a href="#using-temporary" class="headerlink" title="using temporary"></a>using temporary</h4><p><code>using temporary:</code>性能损耗大 ，用到了临时表。一般出现在<code>group by</code> 语句中。</p>
<p>查询那些列，就根据那些列 <code>group by</code></p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token number">a1</span> <span class="token keyword">from</span> test02 <span class="token keyword">where</span> <span class="token number">a1</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">)</span> <span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token number">a1</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+--------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span>  <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>          <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+--------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test02 <span class="token operator">|</span> <span class="token keyword">index</span> <span class="token operator">|</span> idx_a1_a2_a3  <span class="token operator">|</span> idx_a1_a2_a3 <span class="token operator">|</span> <span class="token number">30</span>      <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">index</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+--------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token number">a1</span> <span class="token keyword">from</span> test02 <span class="token keyword">where</span> <span class="token number">a1</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">)</span> <span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token number">a2</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+-----------------------------------------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span>  <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>          <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                                                     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+-----------------------------------------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test02 <span class="token operator">|</span> <span class="token keyword">index</span> <span class="token operator">|</span> idx_a1_a2_a3  <span class="token operator">|</span> idx_a1_a2_a3 <span class="token operator">|</span> <span class="token number">30</span>      <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">index</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">temporary</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> filesort <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+-----------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

</code></pre>
<h4 id="using-index"><a href="#using-index" class="headerlink" title="using index"></a>using index</h4><p>性能提升; 索引覆盖（覆盖索引）。原因：不读取原文件，只从索引文件中获取数据 （不需要回表查询）</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">show</span> <span class="token keyword">index</span> <span class="token keyword">from</span> test02<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">--------+------------+--------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> <span class="token keyword">Table</span>  <span class="token operator">|</span> Non_unique <span class="token operator">|</span> Key_name     <span class="token operator">|</span> Seq_in_index <span class="token operator">|</span> Column_name <span class="token operator">|</span> Collation <span class="token operator">|</span> Cardinality <span class="token operator">|</span> Sub_part <span class="token operator">|</span> Packed <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> Index_type <span class="token operator">|</span> <span class="token keyword">Comment</span> <span class="token operator">|</span> Index_comment <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">--------+------------+--------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token operator">|</span> test02 <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> idx_a1_a2_a3 <span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span> <span class="token number">a1</span>          <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">0</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span> test02 <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> idx_a1_a2_a3 <span class="token operator">|</span>            <span class="token number">2</span> <span class="token operator">|</span> <span class="token number">a2</span>          <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">0</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span> test02 <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> idx_a1_a2_a3 <span class="token operator">|</span>            <span class="token number">3</span> <span class="token operator">|</span> <span class="token number">a3</span>          <span class="token operator">|</span> A         <span class="token operator">|</span>           <span class="token number">0</span> <span class="token operator">|</span>     <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>   <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token keyword">BTREE</span>      <span class="token operator">|</span>         <span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">--------+------------+--------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token number">a1</span><span class="token punctuation">,</span><span class="token number">a2</span> <span class="token keyword">from</span> test02 <span class="token keyword">where</span> <span class="token number">a1</span><span class="token operator">=</span><span class="token string">''</span> <span class="token operator">or</span> <span class="token number">a2</span><span class="token operator">=</span> <span class="token string">''</span> <span class="token punctuation">;</span> 
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+--------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span>  <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>          <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+--------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test02 <span class="token operator">|</span> <span class="token keyword">index</span> <span class="token operator">|</span> idx_a1_a2_a3  <span class="token operator">|</span> idx_a1_a2_a3 <span class="token operator">|</span> <span class="token number">30</span>      <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">index</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+--------------+---------+------+------+--------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">drop</span> <span class="token keyword">index</span> idx_a1_a2_a3 <span class="token keyword">on</span> test02<span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">table</span> test02 <span class="token keyword">add</span> <span class="token keyword">index</span> idx_a1_a2<span class="token punctuation">(</span><span class="token number">a1</span><span class="token punctuation">,</span><span class="token number">a2</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">0</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token number">a1</span><span class="token punctuation">,</span><span class="token number">a3</span> <span class="token keyword">from</span> test02 <span class="token keyword">where</span> <span class="token number">a1</span><span class="token operator">=</span><span class="token string">''</span> <span class="token operator">or</span> <span class="token number">a3</span><span class="token operator">=</span> <span class="token string">''</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>  <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test02 <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> idx_a1_a2     <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+------+---------------+------+---------+------+------+-------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<p>如果用到了索引覆盖<code>(using index时)</code>，会对<code>possible_keys</code>和<code>key</code>造成影响：</p>
<p>如果没有<code>where</code>，则索引只出现在<code>key</code>中；如果有<code>where</code>，则索引 出现在<code>key</code>和<code>possible_keys</code>中。</p>
<pre class=" language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token number">a1</span><span class="token punctuation">,</span><span class="token number">a2</span> <span class="token keyword">from</span> test02 <span class="token keyword">where</span> <span class="token number">a1</span><span class="token operator">=</span><span class="token string">''</span> <span class="token operator">or</span> <span class="token number">a2</span><span class="token operator">=</span> <span class="token string">''</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+-----------+---------+------+------+--------------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span>  <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>       <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+-----------+---------+------+------+--------------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test02 <span class="token operator">|</span> <span class="token keyword">index</span> <span class="token operator">|</span> idx_a1_a2     <span class="token operator">|</span> idx_a1_a2 <span class="token operator">|</span> <span class="token number">20</span>      <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span><span class="token punctuation">;</span> <span class="token keyword">Using</span> <span class="token keyword">index</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+-----------+---------+------+------+--------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> 
mysql<span class="token operator">></span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token number">a1</span><span class="token punctuation">,</span><span class="token number">a2</span> <span class="token keyword">from</span> test02  <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+-----------+---------+------+------+-------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span>  <span class="token operator">|</span> <span class="token keyword">type</span>  <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>       <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+-----------+---------+------+------+-------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> test02 <span class="token operator">|</span> <span class="token keyword">index</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> idx_a1_a2 <span class="token operator">|</span> <span class="token number">20</span>      <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">index</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">----+-------------+--------+-------+---------------+-----------+---------+------+------+-------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre>
<h2 id="查看SQL性能使用情况"><a href="#查看SQL性能使用情况" class="headerlink" title="查看SQL性能使用情况"></a>查看SQL性能使用情况</h2><pre><code>mysql&gt; select @@profiling;
+-------------+
| @@profiling |
+-------------+
|           0 |
+-------------+
1 row in set (0.00 sec)

mysql&gt; set profiling=1; 
Query OK, 0 rows affected (0.00 sec)

mysql&gt; select @@profiling;
+-------------+
| @@profiling |
+-------------+
|           1 |
+-------------+
1 row in set (0.00 sec)

mysql&gt; select sleep(20);
+-----------+
| sleep(20) |
+-----------+
|         0 |
+-----------+
1 row in set (20.00 sec)

mysql&gt; show profiles;
+----------+-------------+--------------------+
| Query_ID | Duration    | Query              |
+----------+-------------+--------------------+
|        1 |  0.00007700 | select @@profiling |
|        2 | 20.00080200 | select sleep(20)   |
+----------+-------------+--------------------+
2 rows in set (0.00 sec)

mysql&gt; show profile;
+----------------------+-----------+
| Status               | Duration  |
+----------------------+-----------+
| starting             |  0.000033 |
| checking permissions |  0.000002 |
| Opening tables       |  0.000004 |
| init                 |  0.000006 |
| optimizing           |  0.000002 |
| executing            |  0.000006 |
| User sleep           | 20.000621 |
| end                  |  0.000012 |
| query end            |  0.000002 |
| closing tables       |  0.000002 |
| freeing items        |  0.000042 |
| logging slow query   |  0.000003 |
| logging slow query   |  0.000065 |
| cleaning up          |  0.000004 |
+----------------------+-----------+
14 rows in set (0.00 sec)

mysql&gt; show profile cpu,swaps for query 2;
+----------------------+-----------+----------+------------+-------+
| Status               | Duration  | CPU_user | CPU_system | Swaps |
+----------------------+-----------+----------+------------+-------+
| starting             |  0.000033 | 0.000000 |   0.000000 |     0 |
| checking permissions |  0.000002 | 0.000000 |   0.000000 |     0 |
| Opening tables       |  0.000004 | 0.000000 |   0.000000 |     0 |
| init                 |  0.000006 | 0.000000 |   0.000000 |     0 |
| optimizing           |  0.000002 | 0.000000 |   0.000000 |     0 |
| executing            |  0.000006 | 0.000000 |   0.000000 |     0 |
| User sleep           | 20.000621 | 0.006000 |   0.005999 |     0 |
| end                  |  0.000012 | 0.000000 |   0.000000 |     0 |
| query end            |  0.000002 | 0.000000 |   0.000000 |     0 |
| closing tables       |  0.000002 | 0.000000 |   0.000000 |     0 |
| freeing items        |  0.000042 | 0.000000 |   0.000000 |     0 |
| logging slow query   |  0.000003 | 0.000000 |   0.000000 |     0 |
| logging slow query   |  0.000065 | 0.000000 |   0.000000 |     0 |
| cleaning up          |  0.000004 | 0.000000 |   0.000000 |     0 |
+----------------------+-----------+----------+------------+-------+
14 rows in set (0.00 sec)</code></pre><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://www.hollischuang.com/archives/3818" target="_blank" rel="noopener">我以为我对Mysql索引很了解，直到我遇到了阿里的面试官-HollisChuang’s Blog</a></p>

            </div>
            <hr/>

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-large waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            

    <div class="reprint" id="reprint-statement">
        <p class="reprint-tip">
            <i class="fa fa-exclamation-triangle"></i>&nbsp;&nbsp;
            <span>转载规则</span>
        </p>
        
            <div class="center-align">
                <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">
                    <img alt=""
                         style="border-width:0"
                         src="https://i.creativecommons.org/l/by/4.0/88x31.png"/>
                </a>
            </div>
            <br/>
            <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text"
                  property="dct:title" rel="dct:type">
                    《mysql》
                </span> 由
            <a xmlns:cc="http://creativecommons.org/ns#" href="/2019/06/08/mysql/" property="cc:attributionName"
               rel="cc:attributionURL">
                shenlibing
            </a> 采用
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">
                知识共享署名 4.0 国际许可协议
            </a>进行许可。
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>


        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '7b42617f95211d5847fc',
        clientSecret: 'e272c54840e0b98ae6fda880655f266b1923bc3f',
        repo: 'shenlibing.github.io',
        owner: 'shenlibing',
        admin: "shenlibing",
        id: '2019-06-08T16-08-53',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2019/06/13/dubbo/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/14.jpg" class="responsive-img" alt="dubbo">
                        
                        <span class="card-title">dubbo</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            阿里分布式框架dubbo，zookeeper注册服务
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2019-06-13
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/分布式/" class="post-category" target="_blank">
                                    分布式
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/dubbo/" target="_blank">
                        <span class="chip bg-color">dubbo</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2019/05/25/html5-te-xing-css3-ji-chu-html5-yi-dong-duan-ji-chu-touch-shi-jian-ji-chu-touch-duo-dian-hong-mo-shi-jian/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/11.jpg" class="responsive-img" alt="HTML5特性_CSS3基础_HTML5移动端基础_touch事件基础_touch多点触摸事件">
                        
                        <span class="card-title">HTML5特性_CSS3基础_HTML5移动端基础_touch事件基础_touch多点触摸事件</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            html5的新特性geolocation、localStorage、WebWorker、canvas，css3的样式新特性transform、transition、animation，移动端、触摸事件的使用
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2019-05-25
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/前端/" class="post-category" target="_blank">
                                    前端
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/HTML5-CSS3/" target="_blank">
                        <span class="chip bg-color">HTML5 CSS3</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h1,h2, h3, h4,h5,h6'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1,h2, h3, h4,h5,h6').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>


<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            本站由&copy;<a href="https://github.com/shenlibing" target="_blank">shenlibing</a>基于
            <a href="https://hexo.io/" target="_blank">Hexo</a> 的
            <a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">hexo-theme-matery</a>主题搭建.

              <!-- 友情链接:<a href="http://www.ityouknow.com/" target="_blank">纯洁的微笑</a>  -->
    </div>
</footer>

<div class="progress-bar"></div>


<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->



    <script src="/libs/others/clicklove.js"></script>


    <script async src="/libs/others/busuanzi.pure.mini.js"></script>


</body>
</html>